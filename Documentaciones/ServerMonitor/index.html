<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentaci√≥n - ServerMonitorApp</title>
    <style>
        :root {
            --primary: #3b82f6;
            --bg: #f8fafc;
            --text: #1e293b;
            --card-bg: #ffffff;
        }

        body {
            font-family: system-ui, -apple-system, sans-serif;
            line-height: 1.6;
            color: var(--text);
            background: var(--bg);
            margin: 0;
            padding: 2rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid #e2e8f0;
        }

        h1 {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: #64748b;
            font-size: 1.1rem;
        }

        section {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            margin-bottom: 2rem;
        }

        h2 {
            color: var(--primary);
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 0.5rem;
        }

        h3 {
            color: #475569;
            margin-top: 1.5rem;
        }

        /* Bit√°cora Styles */
        .prompt-card {
            background: #f1f5f9;
            border-left: 4px solid var(--primary);
            padding: 1rem;
            margin: 1.5rem 0;
            border-radius: 0 8px 8px 0;
        }

        .prompt-text {
            font-style: italic;
            color: #475569;
        }

        .implementation {
            margin-top: 1rem;
        }

        .tag {
            display: inline-block;
            background: #dbeafe;
            color: #1e40af;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        /* Feature Cards Styles */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .feature-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            padding: 15px;
            border-radius: 8px;
        }

        .feature-card h4 {
            margin: 0 0 10px 0;
            color: #1e293b;
        }

        footer {
            text-align: center;
            margin-top: 4rem;
            color: #94a3b8;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1>ServerMonitorApp</h1>
            <div class="subtitle">Infraestructura H√≠brida de Monitorizaci√≥n (Next.js + Supabase + Docker)</div>
            <p><strong>Versi√≥n:</strong> 1.0.0 | <strong>Estado:</strong> <span
                    style="color:#16a34a; font-weight:bold;">Completado</span></p>
        </header>

        <section id="vision">
            <h2>1. Visi√≥n y Estrategia</h2>
            <p><strong>ServerMonitorApp</strong> es un dashboard de control centralizado para infraestructura remota.
                Permite visualizar m√©tricas en tiempo real, gestionar contenedores Docker y controlar servidores via
                RPC, todo bajo una interfaz moderna y segura.</p>
            <ul>
                <li><strong>Infraestructura</strong>: MV Local (192.168.1.155) / VPS Ubuntu 24.04 con Cloudflare Tunnel.
                </li>
                <li><strong>Backend</strong>: Agente Node.js + Supabase (Self-hosted) + Edge Functions.</li>
                <li><strong>Frontend</strong>: Next.js 14 + Tremor UI + Tailwind CSS.</li>
            </ul>
        </section>

        <section id="features">
            <h2>2. Caracter√≠sticas Destacadas (v1.0)</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>üé® Interfaz Premium & Temas</h4>
                    <p>Dashboard reactivo con <strong>Modo Oscuro/Claro</strong> autom√°tico. Dise√±o tipo "Glassmorphism"
                        con animaciones suaves.</p>
                </div>
                <div class="feature-card">
                    <h4>üé≤ Modo Simulaci√≥n</h4>
                    <p>Permite demo offline usando <code>mockData.ts</code>. Genera m√©tricas sinusoidal realistas y
                        simula un entorno Docker activo.</p>
                </div>
                <div class="feature-card">
                    <h4>üåê Monitorizaci√≥n Externa</h4>
                    <p>Integraci√≥n con <strong>GitHub/NPM Status</strong> y <strong>Security Feed (CVEs)</strong>
                        mediante Proxy interno para evitar CORS.</p>
                </div>
            </div>
        </section>

        <section id="bitacora">
            <h2>3. Bit√°cora de Desarrollo</h2>

            <div class="entry">
                <div class="prompt-card">
                    <div class="prompt-text">"¬øQu√© vamos a hacer hoy? (He analizado el PDF y estoy listo para crear el
                        Manifiesto y el Hito 1 de infraestructura)."</div>
                </div>
                <div class="implementation">
                    <span class="tag">Inicio del Proyecto</span>
                    <p>Se inicializ√≥ la estructura del proyecto y se cre√≥ el <code>manifiesto.md</code>.</p>
                </div>
            </div>

            <div class="entry">
                <div class="prompt-card">
                    <div class="prompt-text">"he cambiado donde se aloja el servidor, esta vez en una mv local..."</div>
                </div>
                <div class="implementation">
                    <span class="tag">Re-Planificaci√≥n</span>
                    <p>Adaptaci√≥n de credenciales para usar MV Local (192.168.2.154).</p>
                </div>
            </div>

            <div class="entry">
                <div class="prompt-card">
                    <div class="prompt-text">"investiga apis que te he dejado en el archivo de Investigador.txt PARA
                        aplicarlo bien"</div>
                </div>
                <div class="implementation">
                    <span class="tag">Investigaci√≥n</span>
                    <p>Incorporaci√≥n de API de Geolocalizaci√≥n (<code>ip-api.com</code>).</p>
                </div>
            </div>

            <div class="entry">
                <div class="prompt-card">
                    <div class="prompt-text">"me sale esto (Screenshots de √©xito)"</div>
                </div>
                <div class="implementation">
                    <span class="tag">Verificaci√≥n Final</span>
                    <p>Validaci√≥n visual del Dashboard funcionando y correcci√≥n de dependencias.</p>
                </div>
            </div>

            <!-- Nuevas Entradas (Sesi√≥n Actual) -->
            <div class="entry">
                <div class="prompt-card">
                    <div class="prompt-text">"opci√≥n para simular datos y modo claro/oscuro"</div>
                </div>
                <div class="implementation">
                    <span class="tag">Frontend Feature</span>
                    <p>
                        - Implementado <strong>Modo Simulaci√≥n</strong> con generador de datos local
                        (`mockData.ts`).<br>
                        - Implementado <strong>Cambio de Tema</strong> (Light/Dark) con `next-themes`.
                    </p>
                </div>
            </div>

            <div class="entry">
                <div class="prompt-card">
                    <div class="prompt-text">"aplicame la de github y la de CVes"</div>
                </div>
                <div class="implementation">
                    <span class="tag">API Integration</span>
                    <p>
                        - Creaci√≥n de <code>ExternalStatus.tsx</code> para GitHub/NPM status.<br>
                        - Creaci√≥n de <code>SecurityFeed.tsx</code> para lista de CVEs.<br>
                        - Integraci√≥n en Dashboard (Layout Grid Footer).
                    </p>
                </div>
            </div>

            <div class="entry">
                <div class="prompt-card">
                    <div class="prompt-text">"sigue cargando el CVES... he montado al final una vm local..."</div>
                </div>
                <div class="implementation">
                    <span class="tag">Bugfix & Config</span>
                    <p>
                        - <strong>Fix CORS:</strong> Implementado Proxy API (`/api/cve`) para peticiones externas.<br>
                        - <strong>Fix Disk Usage:</strong> Parsing din√°mico de m√©tricas de disco.<br>
                        - Actualizaci√≥n de `.env.local` para nueva IP (192.168.1.155).
                    </p>
                </div>
            </div>

            <div class="entry">
                <div class="prompt-card">
                    <div class="prompt-text">"documenta esto: ¬°Excelente decisi√≥n! Con el espacio en disco
                        solucionado..."</div>
                </div>
                <div class="implementation">
                    <span class="tag">Documentation</span>
                    <p>Inclusi√≥n de la <strong>Gu√≠a de Instalaci√≥n desde Cero</strong> para despliegue en VM limpia.</p>
                </div>
            </div>

            <div class="entry">
                <div class="prompt-card">
                    <div class="prompt-text">"documenta esto: ¬°Excelente decisi√≥n! Con el espacio en disco
                        solucionado..."</div>
                </div>
                <div class="implementation">
                    <span class="tag">Documentation</span>
                    <p>Inclusi√≥n de la <strong>Gu√≠a de Instalaci√≥n desde Cero</strong> para despliegue en VM limpia.</p>
                </div>
            </div>

            <div class="entry">
                 <div class="prompt-card">
                     <div class="prompt-text">"hazme un script autoarrancable... actualizame los archivos env"</div>
                 </div>
                 <div class="implementation">
                     <span class="tag">Final Polish</span>
                     <p>
                         - <strong>Server Auto-Start:</strong> Script `server_autostart.sh` para SystemD y Docker.<br>
                         - <strong>Container Mgmt:</strong> Gesti√≥n de contenedores (Start/Stop) desde el Frontend.<br>
                         - <strong>Deploy Fixes:</strong> Ajuste de permisos Docker (usermod) y mapeo de puertos.
                     </p>
                 </div>
             </div>
        </section>

        <section id="features-new">
            <h2>4.0 Novedades Finales</h2>
            <div class="feature-grid">
                 <div class="feature-card">
                     <h4>üì¶ Gesti√≥n de Contenedores</h4>
                     <p>Control total con rutas din√°micas <code>/container?id=x</code> compatibles con Exportaci√≥n Est√°tica. Gr√°ficos de CPU/RAM por contenedor.</p>
                 </div>
                 <div class="feature-card">
                     <h4>ü§ñ Auto-Pilot Server</h4>
                     <p>Script <code>server_autostart.sh</code> que garantiza la resiliencia: Si el servidor reinicia, el Agente y Supabase reviven solos.</p>
                 </div>
                 <div class="feature-card">
                     <h4>üõ†Ô∏è Utilitarios CLI</h4>
                     <p>Herramienta <code>./monitor-status.sh</code> en el servidor para diagn√≥stico instant√°neo de salud.</p>
                 </div>
            </div>
        </section>

        <section id="instalacion">
            <h2>4. Gu√≠a de Instalaci√≥n (Clean Install)</h2>
            <p>Procedimiento para desplegar el backend y agente en una VM Ubuntu limpia (192.168.1.155).</p>

            <h3>1Ô∏è‚É£ Requisitos del Sistema</h3>
            <pre style="background:#1e293b; color:#cbd5e1; padding:15px; border-radius:8px; overflow-x:auto;"><code># Actualizar sistema e instalar Docker/Node
sudo apt update && sudo apt upgrade -y
sudo apt install -y docker.io nodejs npm curl

# Configurar permisos de Docker
sudo usermod -aG docker $USER
newgrp docker</code></pre>

            <h3>2Ô∏è‚É£ Backend (Supabase)</h3>
            <pre style="background:#1e293b; color:#cbd5e1; padding:15px; border-radius:8px; overflow-x:auto;"><code># Instalar CLI y arrancar
mkdir -p ~/ServerMonitorApp && cd ~/ServerMonitorApp
curl -L https://github.com/supabase/cli/releases/latest/download/supabase_linux_amd64.tar.gz -o supabase.tar.gz
tar -xf supabase.tar.gz && sudo mv supabase /usr/local/bin/

supabase init
supabase start</code></pre>
            <p><em>Nota: Copia la <code>service_role key</code> y la <code>API URL</code> que aparecen al
                    finalizar.</em></p>

            <h3>3Ô∏è‚É£ Aplicar Esquema SQL</h3>
            <p>Accede a <a href="http://192.168.1.155:54323" target="_blank">http://192.168.1.155:54323</a> -> SQL
                Editor y ejecuta el script <code>schema.sql</code>.</p>

            <h3>4Ô∏è‚É£ Agente de Monitorizaci√≥n</h3>
            <pre style="background:#1e293b; color:#cbd5e1; padding:15px; border-radius:8px; overflow-x:auto;"><code>mkdir -p ~/ServerMonitorApp/agent && cd ~/ServerMonitorApp/agent
npm init -y
npm install @supabase/supabase-js os-utils

# Crear index.js (Ver archivo del proyecto para contenido completo)
# Recuerda poner tu URL y SERVICE_ROLE_KEY</code></pre>

            <h3>5Ô∏è‚É£ Persistencia (PM2)</h3>
            <pre style="background:#1e293b; color:#cbd5e1; padding:15px; border-radius:8px; overflow-x:auto;"><code>sudo npm install -g pm2
pm2 start index.js --name "agente-servidor"
pm2 save
pm2 startup</code></pre>
        </section>

        <section id="accesos">
            <h2>5. Resumen de Acceso (Entorno Local)</h2>
            <div class="feature-card" style="background: #1e293b; color: white; border: none;">
                <h4 style="color: #60a5fa; margin-bottom: 15px;">üìù Datos de Conexi√≥n (VM: 192.168.1.155)</h4>
                <ul style="list-style: none; padding: 0;">
                    <li style="margin-bottom: 10px;">
                        <strong>ü©∫ Dashboard (Studio):</strong><br>
                        <a href="http://192.168.1.155:54323" target="_blank"
                            style="color: #38bdf8; text-decoration: none;">http://192.168.1.155:54323</a>
                    </li>
                    <li style="margin-bottom: 10px;">
                        <strong>üîå API URL (Supabase):</strong><br>
                        <code style="background: #334155; color: #e2e8f0;">http://192.168.1.155:54321</code>
                    </li>
                    <li style="margin-bottom: 10px;">
                        <strong>üêû Logs del Agente:</strong><br>
                        <span style="color: #94a3b8;">Escribe </span><code
                            style="background: #334155; color: #fbbf24;">pm2 logs</code><span style="color: #94a3b8;">
                            en la terminal para depurar.</span>
                    </li>
                </ul>
            </div>
        </section>

        <footer>
            <p>Desarrollado por Roberto Monedero Alonso</p>
            <p>&copy; 2026 ServerMonitorApp</p>
        </footer>
    </div>
</body>

</html>